/*
tail -n 1000000 /var/log/nginx/access.log | egrep 'SELECT.*CONCAT' | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | egrep 'SELECT.*INFORMATION_SCHEMA.SCHEMA' | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | egrep 'EXTRACTVALUE.*SELECT' | awk '{print $1;}' | sort | uniq
*/ /*

tail -n 1000000 /var/log/nginx/access.log | grep "OAI-SearchBot" | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep bingbot | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep Twitterbot | awk '{print $1;}' | sort | uniq




tail -n 1000000 /var/log/nginx/access.log | grep amazonbot | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep TelegramBot | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep PetalBot | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep PerplexityBot | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep "Mail.RU_Bot" | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep "YandexBot" | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep "CCBot" | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep "GPTBot" | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep "dataforseo-bot" | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep "SemrushBot-BA" | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep Bytespider | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep DataForSeoBot | awk '{print $1;}' | sort | uniq
tail -n 1000000 /var/log/nginx/access.log | grep MJ12bot | awk '{print $1;}' | sort | uniq

*/
// tail -n 1000000 /var/log/nginx/access.log | grep Bot | awk '{print $1;}' | sort | uniq
// tail -n 1000000 /var/log/nginx/access.log | grep Amazonbot | awk '{print $1;}' | sort | uniq
/* 아래의 명령어를 한번에 한다.

*/
//
//
//
//
// # tail -f /var/log/nginx/access.log | grep "GET /?"

void main() {
  String ips = r'''
20.171.207.103
20.171.207.149
20.171.207.154
20.171.207.160
20.171.207.187
20.171.207.21
20.171.207.242
20.171.207.3
20.171.207.47
20.171.207.52
20.171.207.54
4.227.36.102
4.227.36.108
4.227.36.23
4.227.36.28
4.227.36.49
4.227.36.50
4.227.36.58
4.227.36.65
4.227.36.83
17.22.253.187
17.241.219.10
17.241.219.101
17.241.219.103
17.241.219.104
17.241.219.105
17.241.219.108
17.241.219.109
17.241.219.113
17.241.219.116
17.241.219.118
17.241.219.121
17.241.219.122
17.241.219.123
17.241.219.124
17.241.219.127
17.241.219.128
17.241.219.129
17.241.219.13
17.241.219.131
17.241.219.134
17.241.219.137
17.241.219.138
17.241.219.142
17.241.219.143
17.241.219.144
17.241.219.148
17.241.219.149
17.241.219.15
17.241.219.150
17.241.219.152
17.241.219.156
17.241.219.157
17.241.219.158
17.241.219.159
17.241.219.16
17.241.219.160
17.241.219.162
17.241.219.17
17.241.219.171
17.241.219.176
17.241.219.178
17.241.219.179
17.241.219.18
17.241.219.183
17.241.219.186
17.241.219.188
17.241.219.189
17.241.219.19
17.241.219.190
17.241.219.191
17.241.219.194
17.241.219.195
17.241.219.196
17.241.219.198
17.241.219.200
17.241.219.201
17.241.219.204
17.241.219.205
17.241.219.208
17.241.219.209
17.241.219.21
17.241.219.210
17.241.219.211
17.241.219.212
17.241.219.213
17.241.219.215
17.241.219.217
17.241.219.22
17.241.219.220
17.241.219.221
17.241.219.226
17.241.219.229
17.241.219.23
17.241.219.230
17.241.219.235
17.241.219.237
17.241.219.24
17.241.219.241
17.241.219.242
17.241.219.244
17.241.219.245
17.241.219.247
17.241.219.249
17.241.219.25
17.241.219.26
17.241.219.28
17.241.219.33
17.241.219.36
17.241.219.38
17.241.219.39
17.241.219.40
17.241.219.42
17.241.219.45
17.241.219.46
17.241.219.48
17.241.219.49
17.241.219.51
17.241.219.52
17.241.219.54
17.241.219.55
17.241.219.57
17.241.219.6
17.241.219.63
17.241.219.64
17.241.219.66
17.241.219.67
17.241.219.71
17.241.219.73
17.241.219.8
17.241.219.80
17.241.219.81
17.241.219.83
17.241.219.84
17.241.219.87
17.241.219.88
17.241.219.90
17.241.219.92
17.241.219.93
17.241.219.94
17.241.219.99
17.241.227.102
17.241.227.103
17.241.227.104
17.241.227.105
17.241.227.106
17.241.227.107
17.241.227.109
17.241.227.117
17.241.227.118
17.241.227.119
17.241.227.120
17.241.227.121
17.241.227.122
17.241.227.123
17.241.227.126
17.241.227.128
17.241.227.13
17.241.227.136
17.241.227.137
17.241.227.138
17.241.227.14
17.241.227.142
17.241.227.144
17.241.227.146
17.241.227.153
17.241.227.156
17.241.227.158
17.241.227.162
17.241.227.163
17.241.227.164
17.241.227.166
17.241.227.167
17.241.227.169
17.241.227.171
17.241.227.175
17.241.227.176
17.241.227.178
17.241.227.179
17.241.227.18
17.241.227.183
17.241.227.186
17.241.227.19
17.241.227.190
17.241.227.194
17.241.227.198
17.241.227.199
17.241.227.200
17.241.227.201
17.241.227.203
17.241.227.204
17.241.227.205
17.241.227.206
17.241.227.208
17.241.227.21
17.241.227.211
17.241.227.212
17.241.227.214
17.241.227.215
17.241.227.218
17.241.227.221
17.241.227.223
17.241.227.225
17.241.227.227
17.241.227.228
17.241.227.229
17.241.227.235
17.241.227.236
17.241.227.237
17.241.227.238
17.241.227.239
17.241.227.240
17.241.227.242
17.241.227.244
17.241.227.245
17.241.227.247
17.241.227.248
17.241.227.252
17.241.227.253
17.241.227.27
17.241.227.29
17.241.227.31
17.241.227.35
17.241.227.37
17.241.227.41
17.241.227.44
17.241.227.46
17.241.227.48
17.241.227.5
17.241.227.51
17.241.227.54
17.241.227.55
17.241.227.57
17.241.227.6
17.241.227.60
17.241.227.61
17.241.227.63
17.241.227.65
17.241.227.66
17.241.227.67
17.241.227.68
17.241.227.69
17.241.227.72
17.241.227.74
17.241.227.75
17.241.227.79
17.241.227.8
17.241.227.80
17.241.227.81
17.241.227.83
17.241.227.86
17.241.227.88
17.241.227.9
17.241.227.91
17.241.227.92
17.241.227.94
17.241.227.95
17.241.227.97
17.241.227.98
17.241.75.10
17.241.75.100
17.241.75.102
17.241.75.103
17.241.75.105
17.241.75.107
17.241.75.108
17.241.75.109
17.241.75.11
17.241.75.112
17.241.75.115
17.241.75.116
17.241.75.117
17.241.75.12
17.241.75.120
17.241.75.121
17.241.75.122
17.241.75.128
17.241.75.129
17.241.75.131
17.241.75.135
17.241.75.136
17.241.75.137
17.241.75.138
17.241.75.139
17.241.75.14
17.241.75.144
17.241.75.15
17.241.75.150
17.241.75.152
17.241.75.153
17.241.75.155
17.241.75.156
17.241.75.158
17.241.75.162
17.241.75.163
17.241.75.166
17.241.75.17
17.241.75.170
17.241.75.174
17.241.75.179
17.241.75.18
17.241.75.180
17.241.75.184
17.241.75.185
17.241.75.187
17.241.75.188
17.241.75.191
17.241.75.192
17.241.75.196
17.241.75.197
17.241.75.198
17.241.75.199
17.241.75.20
17.241.75.202
17.241.75.206
17.241.75.207
17.241.75.211
17.241.75.212
17.241.75.213
17.241.75.218
17.241.75.22
17.241.75.220
17.241.75.223
17.241.75.227
17.241.75.228
17.241.75.229
17.241.75.230
17.241.75.232
17.241.75.234
17.241.75.236
17.241.75.237
17.241.75.238
17.241.75.240
17.241.75.241
17.241.75.243
17.241.75.245
17.241.75.246
17.241.75.247
17.241.75.248
17.241.75.249
17.241.75.250
17.241.75.251
17.241.75.252
17.241.75.254
17.241.75.26
17.241.75.30
17.241.75.31
17.241.75.32
17.241.75.35
17.241.75.36
17.241.75.42
17.241.75.46
17.241.75.47
17.241.75.51
17.241.75.52
17.241.75.55
17.241.75.58
17.241.75.59
17.241.75.61
17.241.75.62
17.241.75.63
17.241.75.67
17.241.75.69
17.241.75.71
17.241.75.74
17.241.75.78
17.241.75.8
17.241.75.82
17.241.75.84
17.241.75.85
17.241.75.86
17.241.75.88
17.241.75.89
17.241.75.91
17.241.75.92
17.241.75.95
17.241.75.97
17.241.75.99
13.58.11.68
13.58.117.102
13.58.12.108
13.58.121.29
13.58.199.206
13.58.215.45
13.58.216.183
13.58.238.63
13.58.242.216
13.58.48.103
13.58.67.129
13.58.73.22
13.59.114.66
13.59.134.12
13.59.156.144
13.59.198.133
13.59.203.127
13.59.22.153
13.59.234.246
13.59.243.24
13.59.252.174
13.59.56.153
13.59.84.174
13.59.91.46
18.116.100.166
18.116.20.44
18.116.230.40
18.116.23.178
18.116.238.86
18.116.241.205
18.116.26.90
18.116.36.23
18.116.89.157
18.117.101.118
18.117.10.159
18.117.107.97
18.117.11.129
18.117.111.63
18.117.129.247
18.117.145.188
18.117.146.157
18.117.158.108
18.117.158.174
18.117.162.216
18.117.166.111
18.117.171.169
18.117.174.43
18.117.180.237
18.117.189.90
18.117.189.91
18.117.197.188
18.117.232.238
18.117.244.233
18.117.246.69
18.117.85.73
18.117.93.231
18.118.114.72
18.118.122.147
18.118.122.239
18.118.14.81
18.118.149.213
18.118.151.13
18.118.173.146
18.118.209.158
18.118.217.142
18.118.226.34
18.118.32.116
18.118.37.74
18.118.99.234
18.119.0.68
18.119.102.182
18.119.103.40
18.119.110.206
18.119.112.17
18.119.126.168
18.119.126.21
18.119.132.21
18.119.140.58
18.119.141.157
18.119.143.52
18.119.164.249
18.119.192.101
18.119.248.249
18.119.29.162
18.119.29.99
18.188.103.42
18.188.119.49
18.188.131.162
18.188.146.223
18.188.149.194
18.188.161.182
18.188.176.130
18.188.181.58
18.188.193.228
18.188.250.166
18.188.46.100
18.188.48.106
18.188.80.46
18.188.91.70
18.189.141.66
18.189.143.114
18.189.180.129
18.189.188.113
18.189.188.228
18.189.30.7
18.190.159.222
18.190.239.5
18.191.103.248
18.191.11.237
18.191.120.131
18.191.135.50
18.191.138.59
18.191.144.80
18.191.146.8
18.191.15.150
18.191.152.135
18.191.154.119
18.191.154.2
18.191.165.252
18.191.165.88
18.191.166.168
18.191.167.79
18.191.171.178
18.191.174.190
18.191.187.74
18.191.197.217
18.191.224.22
18.191.24.197
18.191.244.172
18.191.254.28
18.191.255.7
18.191.27.94
18.191.28.161
18.191.31.104
18.191.37.17
18.191.53.120
18.191.54.249
18.191.91.228
18.191.97.68
18.216.219.130
18.216.220.105
18.216.224.72
18.216.230.65
18.216.232.138
18.216.248.35
18.216.31.88
18.216.51.7
18.216.78.190
18.217.119.115
18.217.131.249
18.217.160.127
18.217.166.126
18.217.170.18
18.217.174.142
18.217.212.222
18.217.226.1
18.217.237.153
18.217.244.16
18.217.35.130
18.217.95.146
18.218.102.138
18.218.108.184
18.218.131.147
18.218.137.145
18.218.146.21
18.218.169.79
18.218.209.109
18.218.243.199
18.218.245.163
18.218.61.200
18.219.128.212
18.219.194.232
18.219.197.162
18.219.23.38
18.219.241.228
18.219.40.177
18.219.58.157
18.219.66.32
18.219.81.99
18.219.8.51
18.220.1.197
18.220.182.171
18.220.210.111
18.220.22.253
18.220.23.205
18.220.38.146
18.220.45.179
18.220.47.242
18.220.70.192
18.220.9.180
18.220.96.228
18.221.160.2
18.221.176.186
18.221.207.166
18.221.222.110
18.221.227.158
18.221.240.145
18.221.35.244
18.221.70.17
18.221.83.34
18.221.85.236
18.222.110.185
18.222.112.142
18.222.153.154
18.222.159.83
18.222.166.40
18.222.178.70
18.222.180.149
18.222.183.102
18.222.184.40
18.222.188.218
18.222.197.224
18.222.207.132
18.222.209.172
18.222.22.193
18.222.226.47
18.222.24.23
18.222.5.111
18.222.93.141
18.223.106.232
18.223.134.71
18.223.158.66
18.223.162.245
18.223.209.231
18.223.211.185
18.223.238.221
18.223.239.15
18.223.97.137
18.224.137.108
18.224.149.17
18.224.202.121
18.224.20.254
18.224.21.26
18.224.44.53
18.224.52.33
18.224.54.247
18.224.70.193
18.224.93.225
18.224.96.135
18.225.55.253
18.225.7.106
18.225.92.138
18.225.95.186
18.226.104.194
18.226.159.125
18.226.166.121
18.226.166.64
18.226.181.89
18.226.251.231
18.226.28.28
18.226.4.129
18.226.88.145
18.226.88.23
18.227.102.59
18.227.183.185
18.227.209.41
18.227.72.114
3.12.102.204
3.12.146.79
3.12.146.87
3.12.147.188
3.12.149.192
3.12.149.233
3.12.151.104
3.12.163.164
3.12.198.162
3.128.153.112
3.128.197.221
3.128.203.120
3.128.205.101
3.128.205.62
3.128.31.106
3.128.31.200
3.128.78.43
3.128.95.177
3.129.128.179
3.129.216.70
3.129.71.225
3.132.215.146
3.133.100.195
3.133.100.204
3.133.108.14
3.133.108.227
3.133.112.141
3.133.136.4
3.133.141.166
3.133.145.211
3.133.149.165
3.133.158.178
3.133.59.209
3.133.83.94
3.133.87.185
3.134.104.224
3.134.118.113
3.134.253.166
3.134.92.188
3.134.92.193
3.134.95.211
3.135.182.75
3.135.201.186
3.135.206.125
3.135.215.148
3.135.223.70
3.135.229.106
3.136.17.118
3.136.18.247
3.136.19.165
3.137.169.218
3.137.169.229
3.137.170.78
3.137.172.252
3.137.178.51
3.137.184.32
3.137.198.25
3.137.202.126
3.137.210.169
3.137.213.117
3.137.223.8
3.137.41.2
3.138.101.237
3.138.106.12
3.138.109.3
3.138.112.77
3.138.119.75
3.138.121.183
3.138.140.5
3.138.154.250
3.138.170.222
3.138.199.24
3.138.247.255
3.138.37.184
3.138.60.117
3.139.237.218
3.139.239.109
3.139.239.16
3.139.64.23
3.139.94.189
3.140.184.21
3.140.201.179
3.140.248.104
3.141.107.132
3.141.12.150
3.141.164.124
3.141.193.237
3.141.199.214
3.141.202.216
3.14.12.254
3.141.244.88
3.141.29.119
3.141.31.45
3.14.133.134
3.14.134.62
3.14.144.240
3.141.46.208
3.14.150.131
3.142.12.65
3.142.134.67
3.142.135.246
3.142.135.247
3.142.146.163
3.142.151.216
3.142.221.103
3.142.237.38
3.142.237.71
3.142.240.117
3.142.243.141
3.142.250.99
3.142.43.53
3.14.247.147
3.14.249.46
3.142.53.239
3.143.111.52
3.143.116.179
3.143.143.202
3.143.144.209
3.143.203.21
3.143.203.223
3.143.209.210
3.143.218.86
3.143.228.88
3.143.24.174
3.143.255.34
3.143.7.5
3.144.100.3
3.144.112.72
3.144.12.160
3.144.132.48
3.144.135.25
3.144.143.110
3.144.145.77
3.144.156.43
3.144.165.218
3.144.17.112
3.144.178.2
3.144.17.93
3.144.19.6
3.144.206.193
3.144.237.242
3.144.240.141
3.144.252.203
3.144.254.237
3.144.255.53
3.144.41.223
3.144.6.159
3.144.95.186
3.145.0.77
3.145.138.21
3.145.149.120
3.145.152.98
3.145.158.23
3.145.159.123
3.145.164.105
3.145.170.67
3.145.17.123
3.145.177.173
3.145.179.147
3.145.180.18
3.145.180.66
3.145.188.159
3.145.194.173
3.145.201.156
3.145.213.63
3.145.2.74
3.145.28.3
3.145.38.251
3.145.40.61
3.145.48.156
3.145.68.176
3.145.83.240
3.145.85.23
3.145.86.137
3.145.90.123
3.146.221.49
3.146.37.183
3.14.64.102
3.147.13.233
3.147.2.112
3.147.28.162
3.14.73.0
3.147.44.253
3.147.44.46
3.147.46.129
3.147.52.13
3.147.71.176
3.147.74.90
3.147.76.86
3.147.77.120
3.147.78.141
3.147.79.68
3.147.8.255
3.147.83.234
3.147.8.67
3.148.106.159
3.148.108.24
3.148.108.240
3.148.165.9
3.148.167.99
3.148.170.88
3.148.180.219
3.148.185.226
3.148.194.168
3.148.200.70
3.148.202.74
3.148.217.16
3.148.220.16
3.148.222.68
3.148.223.53
3.148.226.67
3.148.227.92
3.148.231.77
3.148.233.130
3.148.248.235
3.148.252.155
3.148.252.90
3.149.10.88
3.149.214.60
3.149.2.199
3.149.230.209
3.149.230.234
3.149.230.241
3.149.231.42
3.149.239.180
3.149.24.115
3.149.241.32
3.149.249.113
3.149.249.124
3.149.4.109
3.15.10.196
3.15.140.134
3.15.149.154
3.15.149.213
3.15.160.18
3.15.164.218
3.15.165.138
3.15.168.130
3.15.176.204
3.15.189.95
3.15.195.46
3.15.198.191
3.15.201.103
3.15.20.220
3.15.219.78
3.15.221.165
3.15.222.197
3.15.229.189
3.15.26.108
3.15.28.86
3.15.31.125
3.15.31.240
3.15.34.191
3.15.34.228
3.15.7.155
3.15.7.20
3.15.7.241
3.16.1.194
3.16.130.16
3.16.15.52
3.16.206.12
3.16.212.224
3.16.216.138
3.16.24.18
3.16.31.119
3.16.90.150
3.17.142.93
3.17.156.160
3.17.164.48
3.17.166.43
3.17.176.160
3.17.179.163
3.17.179.20
3.17.185.36
3.17.57.190
3.17.60.86
3.17.70.182
3.17.71.93
3.17.73.81
3.17.76.136
3.17.80.220
3.18.105.157
3.19.60.207
3.19.61.131
3.20.206.27
3.20.221.0
3.20.224.152
3.20.239.211
3.21.126.72
3.21.186.117
3.21.241.17
3.21.248.40
3.21.28.69
3.21.35.68
3.21.55.178
3.22.120.195
3.22.166.101
3.22.208.84
3.22.241.171
3.22.63.154
3.22.70.102
3.22.70.233
3.23.102.52
3.23.128.245
3.23.61.129
3.23.86.150
3.23.92.44
52.14.137.94
52.14.150.155
52.14.150.165
52.14.154.79
52.14.176.202
52.14.186.84
52.14.216.203
52.14.228.67
52.14.232.226
52.14.238.102
52.14.77.105
52.14.80.39
52.14.93.216
52.14.93.7
52.15.109.247
52.15.133.37
52.15.174.103
52.15.202.111
52.15.220.116
52.15.225.105
52.15.242.179
52.15.253.106
''';

  List<String> ipList = ips.split('\n');
  ipList.removeWhere((element) => element.isEmpty);
  ipList = ipList.toSet().toList();
  ipList.sort();
  for (String ip in ipList) {
    // remove if it's not an ip address without using regular expression
    if (ip.split('.').length != 4) {
      continue;
    }

    print(
      "firewall-cmd --permanent --add-rich-rule='rule family=\"ipv4\" source address=$ip reject'",
    );
  }
  print("firewall-cmd --reload");
  print("length: " + ipList.length.toString());
}
